#!/usr/bin/env arsh

source ./guniset_helper.arsh

[<CLI(toplevel: $true)>]
type _Param() {
    [<Option(choice:['cpp', 'arsh'], default:"cpp", help:"output type (cpp, arsh), default is cpp")>]
    var type = ""

    [<Arg(help: "specify output")>]
    var output = "/dev/stdout"
}

function gen_for_arsh(output: String) {
    var targets : [String]
    for line in <(guniset enum 'sc') {
        $targets.add($line.split(", ")[1])
    }
    for target in $targets {
        echo -n '    '
        for line in <(guniset sample --limit=3 "sc:${target}") {
            var code = "\$'\\U${$line.slice('U+'.size())}'"
            echo -n "($code, '$target'), "
        }
        echo
    } with > $output
}

_main(p : _Param) {
    case $p.type {
        'cpp' => throw new Error('')
        'arsh' => $gen_for_arsh($p.output)
    }
}

shctl is-sourced || _main $@