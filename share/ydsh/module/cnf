#!/usr/bin/env ydsh

# for command-not-found handling

var CNF_HOOK : ((String, [String]) -> Void)!

var ISDIR_HOOK : ((String) -> Void)!


function DEFAULT_CNF(m : Module, c : String, a : [String]) {
    if $c.indexOf('/') != -1 || $c == '.' || $c == '..' {
        ($ISDIR_HOOK ?? 
            function(s) => { 
                echo 1>&2 $s: is a directory; 
                $? = 1; 
            })($c)
    } else {
        ($CNF_HOOK ?? 
            function(s, ss) => {
                echo 1>&2 $s: command not found; 
                $? = 1; 
            })($c, $a)
    }
}

$CMD_FALLBACK = $DEFAULT_CNF
