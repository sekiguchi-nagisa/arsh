
## read from pipe
var line = echo 'hello world!!' | {
    var e = new LineEditor()
    $e.read()
}
assert $line! == 'hello world!!'


## recursive call
var e = new LineEditor()
$e.setPrompt(function(p) => {
    $e.setCompleter(function(m, s) => $s.split(""))
    $p
})

var ex = 34 as Any
try {
    $e.read()
    assert $false
} catch e { $ex = $e; }
assert $ex is InvalidOperationError

$ex = 34
try {
    $e.setPrompt(function(p) => {
        $e.read()!
    })
    $e.read()
    assert $false
} catch e { $ex = $e; }
assert $ex is InvalidOperationError

$ex = 34
try {
    $e.setPrompt(function(p) => {
        $e.setPrompt(function(s) => $p)
        $p
    })
    $e.read()
    assert $false
} catch e { $ex = $e; }
assert $ex is InvalidOperationError